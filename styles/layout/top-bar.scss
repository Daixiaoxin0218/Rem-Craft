@use "sass:map";
@use "sass:math";
@use "sass:list";

@use "../common" as *;
@use "dock";

$bar-h: 30px;
$item-h: 22px;

$win-control-w: 46px;

$map: (
  "DailyNote": (
    "日记",
    "Alt + 5",
  ),
  "Search": (
    "搜索",
    "Ctrl + P",
  ),
  "ThemeMode": (
    var(--mode-btn),
    var(--mode-after),
  ),
  "History": (
    "历史",
    "Alt + H",
  ),
  "Setting": (
    "设置",
    "Alt + P",
  ),
  "Sync": (
    "同步",
    null,
  ),
);

@mixin top-item {
  @include item("base");
  @include component();
  width: 28px + 8px * 2;
  height: $item-h;
  margin: auto 0;
  padding: 0;
  cursor: unset;
}

@mixin item-before($content) {
  &::before {
    @include reset-position();
    @include reset-style();
    @include v-center($item-h);
    @include center();
    content: $content;
    font-size: map.get($font-size, "small");
    color: map.get($text, "secondary");
    z-index: map.get($z-index, "normal");
    width: 100%;
  }
}

@mixin win-control($svg-w) {
  @include svg-div($win-control-w, $bar-h, $svg-w);
  &::after {
    display: none;
  }
}

//顶部工具栏
.toolbar {
  height: $bar-h;
  margin-top: $interval;

  #toolbarVIP {
    -webkit-app-region: drag;
    $icon-w: 14px; //map.get($icon, "default");
    $width: dock.$item-w + $interval * 2;
    @include svg-div($width, $bar-h, $icon-w);

    &:empty {
      &::before {
        content: "";
        display: block;
        width: $icon-w;
        height: $icon-w;
        background-image: url("#{$asset-path}/icons/siyuan.svg");
        background-repeat: round;
      }
    }

    &:not(:empty) {
      .toolbar__item {
        margin: 0;
        height: $icon-w;
      }
    }
  }

  &__item {
    &::after {
      top: $item-h !important;
      left: 35%;
    }

    @each $id, $contents in $map {
      &#bar#{$id} {
        @include top-item();
        @include item-before(list.nth($contents, 1));
        &::after {
          @if list.nth($contents, 2) {
            content: list.nth($contents, 2);
          }
        }
        svg:not(.ft__secondary) {
          display: none;
        }
      }
    }

    &#barBack,
    &#barForward {
      @include top-item();
      @include svg-div(10px + 12px * 2, $item-h, 10px);
      &.toolbar__item--disabled {
        @include item-disabled();
      }
    }

    &.toolbar__item--win {
      @include win-control(12px);
    }

    &#maxWindow {
      @include win-control(10px);
    }

    &#closeWindow {
      @include win-control(10px);
    }
  }

  #drag {
    @include v-center($bar-h);
  }

  #windowControls {
    top: 0px - $interval !important;
  }
}
